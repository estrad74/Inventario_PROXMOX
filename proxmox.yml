---
plugin: community.general.proxmox
url: '{{ lookup("env", "PROXMOX_HOST") }}'
user: '{{ lookup("env", "PROXMOX_USER") }}'
password: '{{ lookup("env", "PROXMOX_PASSWORD") }}'
validate_certs: false
want_facts: true
qemu_extended_statuses: true
use_extra_vars: true
compose:
  original_name: (proxmox_name | default(""))
  name: (proxmox_name | default("")) | regex_replace('^.*---', '') 
  hostname: (proxmox_name | default("")) | regex_replace('^.*---', '')
  ansible_host: (proxmox_name | default("")) | regex_replace('---.*$', '')
  # Añadir variables personalizadas que puedas usar para filtrar
  is_windows: proxmox_ostype is search('win')
  is_old_ssh: proxmox_name is search('php1pre') or proxmox_name is search ('php2pre) or proxmox_name is search ('liferay1des) or proxmox_name is search ('Sirhuse1des-pagod1des) or proxmox_name is search ('liferay1pre) or proxmox_name is search ('afirma1pre-nucleo) or proxmox_name is search ('afirma2pre-nucleo) or proxmox_name is search ('liferay2pre)
keyed_groups:
  - prefix: os
    key: proxmox_ostype
# Añadir grupos personalizados
groups:
  windows_hosts: is_windows | bool
  old_ssh_hosts: is_old_ssh | bool
  


