---
plugin: community.general.proxmox
url: '{{ lookup("env", "PROXMOX_HOST") }}'
user: '{{ lookup("env", "PROXMOX_USER") }}'
password: '{{ lookup("env", "PROXMOX_PASSWORD") }}'
validate_certs: false
want_facts: true
qemu_extended_statuses: true
use_extra_vars: true
compose:
  original_name: (proxmox_name | default(""))
  name: (proxmox_name | default("")) | regex_replace('^.*---', '') 
  hostname: (proxmox_name | default("")) | regex_replace('^.*---', '')
  ansible_host: (proxmox_name | default("")) | regex_replace('---.*$', '')
keyed_groups:
  - prefix: os
    key: proxmox_ostype
# AÃ±adir grupos personalizados
groups:
  legacy_hosts: >-
    proxmox_name is search('sv0003---php1pre') or 
    proxmox_name is search('sv0004---php2pre') or 
    proxmox_name is search('sv0014---liferay1des') or 
    proxmox_name is search('sv0029---sirhuse1des-pagod1des') or 
    proxmox_name is search('sv0065---liferay1pre') or 
    proxmox_name is search('sv0107---afirma1pre-nucleo') or
    proxmox_name is search('sv0108---afirma2pre-nucleo') or 
    proxmox_name is search('sv0196---liferay2pre')
  linux_no_legacy_hosts: >-
    (proxmox_ostype is search('l26') or
    proxmox_ostype is search('linux')) and
    not (
      proxmox_name is search('sv0003---php1pre') or 
      proxmox_name is search('sv0004---php2pre') or 
      proxmox_name is search('sv0014---liferay1des') or 
      proxmox_name is search('sv0029---sirhuse1des-pagod1des') or 
      proxmox_name is search('sv0065---liferay1pre') or 
      proxmox_name is search('sv0107---afirma1pre-nucleo') or
      proxmox_name is search('sv0108---afirma2pre-nucleo') or 
      proxmox_name is search('sv0196---liferay2pre')
    )
  windows_hosts: >-
    proxmox_ostype is search ('win')
    
   
    
  


